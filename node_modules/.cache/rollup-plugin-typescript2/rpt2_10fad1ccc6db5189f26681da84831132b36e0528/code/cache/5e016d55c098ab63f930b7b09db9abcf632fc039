{"code":"import { jsxs as _jsxs, jsx as _jsx } from \"react/jsx-runtime\";\r\nimport { ContextMenu, MenuItem } from 'react-contextmenu';\r\nimport { useState } from 'react';\r\nimport { useDispatch } from 'react-redux';\r\nimport { FunctionalGroup, setExpandSGroup, fromSgroupDeletion, Action } from 'ketcher-core';\r\nimport { useAppContext } from '../../../../hooks';\r\nimport clsx from 'clsx';\r\nimport classes from './ContextMenu.module.less';\r\nimport { highlightFG } from '../../state/functionalGroups';\r\nconst FGContextMenu = () => {\r\n    const { getKetcherInstance } = useAppContext();\r\n    const dispatch = useDispatch();\r\n    const handleExpand = () => {\r\n        const editor = getKetcherInstance().editor;\r\n        const action = new Action();\r\n        const expandData = targetItems[0].isExpanded;\r\n        targetItems?.forEach((item) => {\r\n            action.mergeWith(setExpandSGroup(editor.render.ctab, item.relatedSGroupId, {\r\n                expanded: !expandData\r\n            }));\r\n        });\r\n        editor.update(action);\r\n        setShowSGroupMenu(false);\r\n        setTargetItems([]);\r\n        highlightFG(dispatch, { group: null, id: null });\r\n    };\r\n    const handleRemove = function () {\r\n        const editor = getKetcherInstance().editor;\r\n        const action = new Action();\r\n        targetItems?.forEach((item) => {\r\n            action.mergeWith(fromSgroupDeletion(editor.render.ctab, item.relatedSGroupId));\r\n        });\r\n        editor.update(action);\r\n        setShowSGroupMenu(false);\r\n        setTargetItems([]);\r\n    };\r\n    const [showSGroupMenu, setShowSGroupMenu] = useState(false);\r\n    const [targetItems, setTargetItems] = useState([]);\r\n    function showMenu(e) {\r\n        const editor = getKetcherInstance().editor;\r\n        const struct = editor.struct();\r\n        const selection = editor.selection();\r\n        setShowSGroupMenu(false);\r\n        setTargetItems([]);\r\n        const selectedItems = [];\r\n        let fgId;\r\n        const ci = editor.findItem({\r\n            clientX: e.detail.position.x,\r\n            clientY: e.detail.position.y\r\n        }, ['sgroups', 'functionalGroups', 'atoms', 'bonds']);\r\n        if (ci) {\r\n            switch (ci.map) {\r\n                case 'atoms':\r\n                    fgId = FunctionalGroup.findFunctionalGroupByAtom(struct.functionalGroups, ci.id);\r\n                    fgId !== null &&\r\n                        struct.functionalGroups.forEach((fg) => {\r\n                            fg.relatedSGroupId === fgId &&\r\n                                !selectedItems.includes(fg) &&\r\n                                selectedItems.push(fg);\r\n                        });\r\n                    break;\r\n                case 'bonds':\r\n                    fgId = FunctionalGroup.findFunctionalGroupByBond(struct, struct.functionalGroups, ci.id);\r\n                    fgId !== null &&\r\n                        struct.functionalGroups.forEach((fg) => {\r\n                            fg.relatedSGroupId === fgId &&\r\n                                !selectedItems.includes(fg) &&\r\n                                selectedItems.push(fg);\r\n                        });\r\n                    break;\r\n                case 'sgroups':\r\n                    const sgroup = struct.sgroups.get(ci.id);\r\n                    if (FunctionalGroup.isFunctionalGroup(sgroup)) {\r\n                        struct.functionalGroups.forEach((fg) => {\r\n                            fg.relatedSGroupId === sgroup?.id &&\r\n                                !selectedItems.includes(fg) &&\r\n                                selectedItems.push(fg);\r\n                        });\r\n                    }\r\n                    break;\r\n                case 'functionalGroups':\r\n                    const fgroup = struct.sgroups.get(ci.id);\r\n                    if (FunctionalGroup.isFunctionalGroup(fgroup)) {\r\n                        struct.functionalGroups.forEach((fg) => {\r\n                            fg.relatedSGroupId === fgroup?.id &&\r\n                                !selectedItems.includes(fg) &&\r\n                                selectedItems.push(fg);\r\n                        });\r\n                    }\r\n                    break;\r\n            }\r\n        }\r\n        if (selection && selection.atoms) {\r\n            selection.atoms.forEach((aid) => {\r\n                const fgId = FunctionalGroup.findFunctionalGroupByAtom(struct.functionalGroups, aid);\r\n                fgId !== null &&\r\n                    struct.functionalGroups.forEach((fg) => {\r\n                        fg.relatedSGroupId === fgId &&\r\n                            !selectedItems.includes(fg) &&\r\n                            selectedItems.push(fg);\r\n                    });\r\n            });\r\n        }\r\n        if (selectedItems.length) {\r\n            setTargetItems(selectedItems);\r\n            setShowSGroupMenu(true);\r\n        }\r\n    }\r\n    return (_jsxs(ContextMenu, { id: \"contextmenu\", onShow: (e) => showMenu(e), className: clsx({\r\n            [classes.isHidden]: !showSGroupMenu\r\n        }), children: [_jsxs(MenuItem, { onClick: handleExpand, children: [targetItems.length && targetItems[0].isExpanded\r\n                        ? 'Contract '\r\n                        : 'Expand ', \"Abbreviation\"] }), _jsx(MenuItem, { divider: true }), _jsx(MenuItem, { onClick: handleRemove, children: \"Remove Abbreviation\" })] }));\r\n};\r\nexport { FGContextMenu };\r\n//# sourceMappingURL=ContextMenu.js.map","references":["/home/ubuntu/work/4life/ketcher/node_modules/react-contextmenu/src/index.d.ts","/home/ubuntu/work/4life/ketcher/node_modules/@types/react/index.d.ts","/home/ubuntu/work/4life/ketcher/node_modules/@types/react-redux/index.d.ts","/home/ubuntu/work/4life/ketcher/packages/ketcher-core/dist/index.d.ts","/home/ubuntu/work/4life/ketcher/packages/ketcher-react/src/hooks/index.ts","/home/ubuntu/work/4life/ketcher/node_modules/clsx/clsx.d.ts","/home/ubuntu/work/4life/ketcher/packages/ketcher-react/src/script/ui/state/functionalGroups/index.ts"],"map":"{\"version\":3,\"file\":\"ContextMenu.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../../../../src/script/ui/component/ContextMenu/ContextMenu.tsx\"],\"names\":[],\"mappings\":\"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\"}","dts":{"name":"/home/ubuntu/work/4life/ketcher/packages/ketcher-react/node_modules/.cache/rollup-plugin-typescript2/placeholder/script/ui/component/ContextMenu/ContextMenu.d.ts","writeByteOrderMark":false,"text":"/// <reference types=\"react\" />\r\ndeclare const FGContextMenu: () => JSX.Element;\r\nexport { FGContextMenu };\r\n"}}
